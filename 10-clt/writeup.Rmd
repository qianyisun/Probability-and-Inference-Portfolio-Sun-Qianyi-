---
title: "10-clt"
author: "Qianyi Sun"
output: 
  html_document:
    theme: united
    #highlight: zenburn
    code_folding: hide
    toc: true
    toc_depth: 3
    toc_float: true
    #number_sections: true
    fig_caption: true
---

# Introduction
he central limit theorem is an important computational short-cut for generating and making inference from the sampling distribution of the mean. You’ll recall that the central limit theorem short-cut relies on a number of conditions, specifically:

Independent observations
Identically distributed observations
Mean and variance exist
Sample size large enough for convergence

# Load library
```{r}
library(magrittr)
library(sn)
```




# Code flow and graphs
```{r fig1, fig.height = 5, fig.width = 5}

R <- 5000
location <- 0
scale <- 1



sample_dist_clt_fun<-function(N,slant){
  Z <- rnorm(R)
  delta <- slant/(sqrt(1+slant^2))
  pop_mean <- location+scale*delta*(sqrt(2/pi)) 
  pop_sd <- sqrt(scale^2*(1-((2*delta^2)/pi)))
  sample_dist_clt <- Z*(pop_sd/sqrt(N))+pop_mean
  return (sample_dist_clt)
}

sample_dist_sim_fun<-function(N,slant){
  delta <- slant/(sqrt(1+slant^2))
  pop_mean <- location+scale*delta*(sqrt(2/pi)) 
  pop_sd <- sqrt(scale^2*(1-((2*delta^2)/pi)))
  random.skew <- array(rsn(R*N,xi=location,omega=scale,alpha=slant),dim = c(R,N))
  sample_dist_sim <- apply(random.skew, 1, mean)
  return(sample_dist_sim)
}

par(mfrow = c(4, 4))
# slant =0
qqplot(sample_dist_sim_fun(5,0),sample_dist_clt_fun(5,0),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(10,0),sample_dist_clt_fun(10,0),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(20,0),sample_dist_clt_fun(20,0),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(40,0),sample_dist_clt_fun(40,0),asp = 1)
abline(0,1)
# slant =2
qqplot(sample_dist_sim_fun(5,2),sample_dist_clt_fun(5,2),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(10,2),sample_dist_clt_fun(10,2),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(20,2),sample_dist_clt_fun(20,2),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(40,2),sample_dist_clt_fun(40,2),asp = 1)
abline(0,1)
# slant =10
qqplot(sample_dist_sim_fun(5,10),sample_dist_clt_fun(5,10),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(10,10),sample_dist_clt_fun(10,10),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(20,10),sample_dist_clt_fun(20,10),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(40,10),sample_dist_clt_fun(40,10),asp = 1)
abline(0,1)
# slant =100
qqplot(sample_dist_sim_fun(5,100),sample_dist_clt_fun(5,100),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(10,100),sample_dist_clt_fun(10,100),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(20,100),sample_dist_clt_fun(20,100),asp = 1)
abline(0,1)
qqplot(sample_dist_sim_fun(40,100),sample_dist_clt_fun(40,100),asp = 1)
abline(0,1)
```

# Explanation for the 4 × 4 factorial experiment graphs
The 16 grashs shows respectively when N is equel to four values including 5, 10, 20, and 40 and the slant will be set to 0, 2, 10 and 100. The x axis names means the sampling distribution of the mean generated by simulatio and  y axis names means the sampling distribution implied by the central limit theorem. Their first input place is N and the second input place is slant. By observing 16 graphs above, we can know that using the central limit theorem is a good way to get the sampling distribution of the mean.




